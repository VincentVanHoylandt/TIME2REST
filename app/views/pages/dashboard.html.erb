<%= render "shared/navbar" %>
<div class="dashboard-main-container" data-controller="dashboard-link">
  <div class="dmc-lc">
    <div class="lc-nav-container">
      <ul class = "nav">
        <li>
          <p class="active" data-action= "click->dashboard-link#switch_page" data-id ="message" data-dashboard-link-target="link">Messageries</p>
        </li>
        <li>
          <p data-action= "click->dashboard-link#switch_page" data-id ="canditature" data-dashboard-link-target="link">Mes canditatures</p>
        </li>
        <li>
          <p data-action= "click->dashboard-link#switch_page" data-id ="offre" data-dashboard-link-target="link">Mes offres</p>
        </li>
        <li>
          <p data-action= "click->dashboard-link#switch_page" data-id ="edit" data-dashboard-link-target="link">Mon profil</p>
        </li>
      </ul>
      <%= link_to destroy_user_session_path, class:"my-disc-btn", data: {turbo_method: :delete} do  %>
        <ul>
          <i class="fa-solid fa-power-off"></i>
          <li>
              Disconnect
          </li>
        </ul>
    <%end%>
    </div>
  </div>


  <div class="dmc-rc">

    <%# --------------------------- %>
    <div class="dmc-rc-message" data-controller="message" data-id ="msg">
      <div class="rc-message-lc">
        <% @participants.each do |participant| %>
          <%= render partial: 'shared/message_card', locals: {img: 'item3.png',
                                                              user: User.find(participant.user_2),
                                                              participant: participant} %>
        <% end %>
      </div>

      <% @participants.each do |participant| %>
        <% user_2 = User.find(participant.user_2) %>
        <div class="rc-message-rc d-none" data-id= <%=participant.id%>  data-message-target="message">
          <div class="msg-rc-tc">
              <div class="avatar-name-container">
                <%= render partial: 'shared/avatar_small', locals: {img: 'item3.png'} %>
                <div class="name-last-online">
                  <h3><%= user_2.first_name + ' ' +user_2.last_name%></h3>
                  <p>Last time online: 20mn</p>
                </div>
              </div>
              <i class="fa-solid fa-trash"></i>
          </div>

          <div class="msg-rc-mc">
            <div class="my-msg-container">
              <div class="my-msg-lc">
              </div>
              <div class="my-msg-rc">
                <p><strong>You :</strong></p>
                <p> Lorem ipsum dolor sit amet consectetur adipisicing elit. Cumque animi eius est, placeat consequuntur
                    eos sed aspernatur ad neque incidunt? Fugit nihil sit ipsa aperiam alias voluptatibus error sapiente ut.</p>
              </div>
            </div>
          </div>

          <div class="msg-rc-bc">
              <%= form_with model: @message, class: "msg-form"  do |f| %>
                <%= f.text_field :name, class: "msg-field" %>
                <%= f.submit class: "msg-btn" %>
              <% end %>

          </div>

        </div>

      <% end %>








    <%# --------------------------- %>
    <div class="dmc-rc-apply d-none d-flex" data-dashboard-link-target="apply" data-id ="cnd">

        <% @user.appliances.each do |appliance| %>
          <%= render partial: 'shared/my_apply_card', locals: {offer: appliance.offer, user: appliance.offer.user} %>
        <% end %>

    </div>
    <div class="dmc-rc-offer d-none" data-dashboard-link-target="offer" data-id ="ofr">
      <% @offers.each do |offer| %>

        <%= render partial: 'shared/offer_card', locals: { offer: offer, user: @user } %>

        <% if offer.appliances != [] %>
          <div class="offers-appliance">
            <ul style = "display: flex;">
            <% offer.appliances.each do |appliance| %>
              <li style = "display: inline-block"> <%= render partial: 'shared/apply_card', locals: {user: appliance.user, appliance: appliance} %></li>
              <% end %>
            </ul>
          </div>
        <% end %>


      <% end %>

    </div>
    <div class="dmc-rc-edit d-none" data-dashboard-link-target="edit" data-id ="edt">
      <div class="lc">
        <%= render partial: 'shared/avatar_large', locals: {img: 'item3.png'} %>
        <div class="name-container">

          <h3> <%=current_user.first_name %> <%=current_user.last_name  %></h3>
        </div>
        <p> <%=current_user.job_title%></p>
        <p> Note : 5 Etoiles</p>
        <ul>
          <li>
            <h3>- Expérience(s)</h3>
          </li>
          <li>
            <h3>- Diplôme(s)</h3>
          </li>
        </ul>
        <%= link_to 'Editer', '#', class: "my-btn-small" %>
      </div>
      <div class="rc">
        <div class="diplomas-container">
          <div class="dc-lc"> </div>
          <div class="dc-rc">
            <h2>Expérience(s)</h2>
            <div class = "diplomas-infos">
              <div class="name-location-date">
                <% current_user.diplomas.each do |diploma| %>
                <h3><%= diploma.title  %></h3>
                <h3>Du <%= diploma.start_time  %> au <%= diploma.end_time  %> </h3>
              </div>
              <p>  <%=diploma.description  %></p>
            </div>
            <% end %>
          </div>
        </div>

        <div class="diplomas-container">
          <div class="dc-lc"> </div>
          <div class="dc-rc">
            <h2>Diplôme(s)</h2>
            <div class = "diplomas-infos">
              <% current_user.experiences.each do |experience| %>
              <h3> <%=experience.title  %></h3>
              <p><%=experience.description  %></p>
                  <% end %>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
